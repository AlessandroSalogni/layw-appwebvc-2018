@model Doctor

<div class="navbar-custom-menu">
	<ul class="nav navbar-nav">
		<!-- Notifications Menu -->
		<li class="dropdown notifications-menu">
			<!-- Menu toggle button -->
			<a href="#" class="dropdown-toggle" data-toggle="dropdown">
				<i class="fa fa-bell"></i>
				<span id="notifications-number" class="label label-warning"></span> @*aumentare numero in base a quando un paziente raggiunge un obiettivo*@
			</a>
			<ul class="dropdown-menu">
				<li class="header">You have 10 notifications</li> @*aumentare numero in base a quando un paziente raggiunge un obiettivo*@
				<li>
					<!-- Inner Menu: contains the notifications -->
					<ul class="menu">
						<li>
							<!-- start notification -->
							<a href="#">
								<i class="fa fa-trophy text-yellow"></i> 5 new members joined today @*il paziente x ha raggiunto l'obiettivo y*@
							</a>
						</li>
						<!-- end notification -->
					</ul>
				</li>
				<li class="footer"><a href="#">View all</a></li>
			</ul>
		</li>
		<!-- User Account Menu -->
		<li class="dropdown user user-menu">
			<!-- Menu Toggle Button -->
			<a href="#" class="dropdown-toggle" data-toggle="dropdown">
				<!-- The user image in the navbar-->
				<img src="@Model.Image" class="user-image" alt="User Image">
				<!-- hidden-xs hides the username on small devices so only the image appears. -->
				<span class="hidden-xs">@Model.Name</span>
			</a>
			<ul class="dropdown-menu">
				<!-- The user image in the menu -->
				<li class="user-header">
					<img src="@Model.Image" class="img-circle" alt="User Image">
					<p>
						@Model.Name
						<small>@Model.Email</small>
					</p>
				</li>
				<!-- Menu Footer-->
				<li class="user-footer">
					<div class="pull-left">
						<a href="#" class="btn btn-default btn-flat">Profile</a>
					</div>
					<div class="pull-right">
						<a href="/signout?doctorEmail=@Model.Email&returnUrl=%2F" class="btn btn-default btn-flat">Sign out</a>
					</div>
				</li>
			</ul>
		</li>
	</ul>
</div>

<script src="~/lib/signalr/signalr.js"></script>
<script type="text/javascript">
	"use strict";
	var numberSpan = document.getElementById("notifications-number");

	if (sessionStorage.getItem("notifications-number") && sessionStorage.getItem("notifications-number") !=  0)
		numberSpan.innerHTML = sessionStorage.getItem("notifications-number");
	else
		sessionStorage.setItem("notifications-number", "0");

	var connection = new signalR.HubConnectionBuilder().withUrl("/mqttHub").build();
	connection.start();

	connection.on("server/@Model.Email", function (message) {
		var number = parseInt(sessionStorage.getItem("notifications-number"));

		sessionStorage.setItem("notifications-number", (number + 1).toString());
		numberSpan.innerHTML = (number + 1).toString();
	});

	//connection.start().catch(function (err) {
	//	return console.error(err.toString());
	//});
</script>