@model Patient
@using System;
@using System.Collections.Generic;
@using LaywApplication.Controllers.Utils;
@using LaywApplication.Models;
@using Newtonsoft.Json.Linq;


<div class="demo-section k-content">
	<div id="tabstrip-activities">
		<ul>
			@{
                //TODO pensare se fare qui una chiamata ajax oppure riempire il modello
				JObject jsonActivities = await APIUtils.GetAsync("https://localhost:44333/dashboard/patients/" + Model.Id + "/activities");
				List<Activity> activities = ((JArray)jsonActivities.GetValue("activities")).GetList<Activity>();

				@*<li class="k-state-active">0.@activities[0].ActivityName</li>*@
					for (int i = 0; i < activities.Count; i++)
					{
                        <li class="mnu-activity" data-id="@i">@activities[i].ActivityName @i</li>
					}
			}
		</ul>
		@{
			for (int i = 0; i < activities.Count; i++)
			{
				<div>
					@{await Html.RenderPartialAsync("PatientActivity", Tuple.Create("activity" + i, "activities", activities[i], Model));}
				</div>
			}
		}
	</div>
</div>

<script>
    $(document).ready(createTabStrip("activities"));
</script>



<script>
    var a = 0;
    
    $(".mnu-activity").click(animateCounter);


    function animateCounter() {
        var divId = "#counter-activity" + $(this).attr('data-id');
        $(divId + ' .counter-value').each(function () {
            var $this = $(this), countTo = $this.attr('data-count'), speed = $this.attr('data-speed');
            $({
                countNum: $this.text()
            }).animate({
                countNum: countTo
            }, {
                    duration: 2500,
                    easing: 'swing',
                    step: function () {
                        $this.text(Math.floor(this.countNum));
                    },
                    complete: function () {
                        $this.text(this.countNum);
                    }
                });
        });
        a = 1;
    }
</script>